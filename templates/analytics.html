{% extends "base.html" %}
{% block content %}
<section class="hero">
  <h1>Analytics</h1>
  <p class="muted">Insights across months and categories</p>
</section>

<section class="grid two">
  <div class="panel">
    <div class="panel-head"><h3>Income vs Spending</h3></div>
    <canvas id="lineChart"></canvas>
  </div>
  <div class="panel">
    <div class="panel-head"><h3>Category Breakdown</h3></div>
    <canvas id="pieChart"></canvas>
  </div>
</section>

<script>
  const months = {{ months|tojson }};
  const income = {{ income_series|tojson }};
  const spending = {{ spending_series|tojson }};
  const catLabels = {{ cat_labels|tojson }};
  const catValues = {{ cat_values|tojson }};

  new Chart(document.getElementById('lineChart'), {
    type:'line',
    data:{ labels: months, datasets:[
      { label:'Income', data: income, tension:.35 },
      { label:'Spending', data: spending, tension:.35 }
    ]},
    options:{ plugins:{ legend:{ position:'bottom' } }, scales:{ y:{ beginAtZero:true } } }
  });

  new Chart(document.getElementById('pieChart'), {
    type:'doughnut',
    data:{ labels: catLabels, datasets:[{ data: catValues }] },
    options:{ plugins:{ legend:{ position:'bottom' } } }
  });
</script>
{% endblock %}
